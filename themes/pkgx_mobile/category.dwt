<!DOCTYPE html>
<html lang="vi-VN">
<!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
<!--[if lt IE 9]>
  <script src="{$option.static_path}/js/html5shiv.js"></script>
  <script src="{$option.static_path}/js/respond.min.js"></script>
<![endif]-->
<head>
    {include file='library/html_header.lbi'}
    {if $keywords}<meta name="keywords" content="{$keywords}"/>{/if}
    <title>{$page_title}</title>
    <link rel="canonical" href="{$base_path}/{$cat_url}"/>
    <link rel="alternate" href="{$base_path}/{$cat_url}" hreflang="vi-vn" />
    <meta property="og:url" itemprop="url" content="{$base_path}/{$cat_url}" />
    <meta itemprop="image" content="{$cat_thumb}" />
    <meta property="og:image" content="{$cat_thumb}" />
    <meta property="og:image:alt" content="{$page_title}" />
    <meta property="og:image:secure_url" itemprop="thumbnailUrl" content="{$cat_thumb}" />
    {* --- Bắt đầu Schema ItemList cho trang danh mục --- *}
    <script type="application/ld+json">
    {
      "@type": "ItemList",
      "name": "{$cat_name|escape:'json'}",
      "description": "{$description|escape:'json'}",
      "numberOfItems": "{$count}",
      "itemListElement": [
        {* Vòng lặp `foreach` cho từng sản phẩm *}
        {foreach from=$goods_list item=goods name=goods_list}
        {
          "@type": "ListItem",
          "position": {$smarty.foreach.goods_list.iteration},
          "item": {
            "@type": "Product",
            "name": "{$goods.name|escape:'json'}",
            "url": "{$base_path}/{$goods.url}",
            "image": "{$cdn_path}/{$goods.goods_thumb}",
            "brand": {
                "@type": "Brand",
                "name": "{$goods.brand_name|default:$shop_name|escape:'json'}"
            },
            "sku": "{$goods.goods_sn|escape:'json'}",
            "offers": {
              "@type": "Offer",
              "priceCurrency": "VND",
              "price": "{$goods.shop_price_raw}",
              "itemCondition": "https://schema.org/NewCondition",
              "availability": "https://schema.org/InStock"
            },
            "description": "{$goods.goods_brief|escape:'json'}"
          }
        }
        {if !$smarty.foreach.goods_list.last},{/if}
        {/foreach}
      ]
    }

    </script>
{* --- Kết thúc Schema ItemList --- *}
    {insert_css files="owl-carousel/owl.carousel.2.1.min.css,css/global.css,css/category.css"}
</head>
<body id="page_{$pname}">
{include file='library/page_header.lbi'}
<section>
     {$render.before_col_main}
     {include file='library/ur_here.lbi'}

    <div class="banner-catalog">
        {insert name=ads id=$ads_id_mobile num=5}
    </div>
    <div class="slidehome">
    <!-- TemplateBeginEditable name="BannerHome" -->
<!-- TemplateEndEditable -->
</div>

    <div class="clr"></div>
    <!-- TemplateBeginEditable name="BanChay" -->
<!-- TemplateEndEditable -->
    <div class="box">
        <div class="hd">
            <h1 class="box_title">{$cat_name}</h1>
            <span class="box_total">({$count} sản phẩm)</span>
        </div>
    </div>
    {if $cat_desc}
<div class="clr"></div>
<article>
        <div class="article_content">
        {$cat_desc}
        </div>
</article>
{/if}
    {if $catsubs}
    <div class="box-cat-list scrollmenu" id="filter_sub">
        <div >
        {foreach from=$catsubs item=sub name=catsub}
          <a href="{$sub.url}">{if $sub.icon}<img height="30" src="{$sub.icon}" alt="{$sub.name|escape}">{/if}{$sub.name|escape}</a> 
        {/foreach}
      </div>
    </div>
    {/if}
{include file='library/cat_filter.lbi'}
    <!-- TemplateBeginEditable name="Main" -->
<!-- #BeginLibraryItem "/library/goods_list.lbi" -->

{if $goods_list}
{if $is_ajax neq 1}
<ul class="homeproduct" id="_loadList">
{/if}
	{foreach from=$goods_list item=goods name=goods_list}
	{if $goods.goods_id}
	<li>
               <div class="labelw">
            {if $goods.is_hot}<span class="label is_hot">Nổi bật</span>{/if}
            {if $goods.is_best}<span class="label is_best">Bán chạy</span>{/if}
            {if $goods.is_new}<span class="label is_new">Mới</span>{/if}
            </div>
        <a href="{$goods.url}" title="{$goods.name|escape:html}">
			{if $goods.thumb_webp}
            <picture>
                <source width="150" height="150" srcset="{$cdn_path}/{$goods.thumb_webp}" type="image/webp" />
                <img width="150" height="150" class="photo" src="{$cdn_path}/{$goods.goods_thumb}" alt="{$goods.name|escape:html}"/>
            </picture>
            {else}
            <img width="150" height="150" class="photo" src="{$cdn_path}/{$goods.goods_thumb}" alt="{$goods.name|escape:html}"/>
            {/if}
{if $goods.goods_number eq 0} <p class="preorder">Hàng đang về</p>{/if}
            {if $goods.discount}<span class="rate">Giảm {$goods.discount}</span>{/if}

            <h3>{$goods.name|escape:html}</h3>
            <div class="price">
                 Giá sỉ {if $goods.promote_price}
                <strong>{$goods.promote_price}</strong><span>{$goods.shop_price}</span>
                 {else}
                 <strong>{$goods.shop_price}</strong>
                {/if}

            </div>
         <p class="cprice">Giá CK: {$goods.partner_price}</p>
                 <!--   <p class="cprice">Giá Lẻ: {$goods.deal_price}</p> -->
            <div class="promotion clr">{$goods.seller_note}</div>
        </a>
         <div class="form_add form_add{$goods.goods_id}">
            <div class="button-container">
                <button onclick="qtyMinus(this)" class="qty_button cart-qty-minus" type="button" value="-">-</button>
                <input type="text" min="1" max="10" class="qty qty{$goods.goods_id}" step="1" name="goods_number" value="1">
                <button onclick="qtyPlus(this)" class="qty_button cart-qty-plus" type="button" value="+">+</button>
            </div>
            <button class="quick_add" type="button" onclick="quickBuy({$goods.goods_id})"><i class="iconmobile-cart"></i></button>
        </div>
    </li>
	{/if}
	{/foreach}
{if $is_ajax neq 1}
</ul>
{include file='library/pages_ajax.lbi'}
{/if}
{else}
<p class="empty">{$lang.goods_empty}</p>
{/if}


 <!-- #EndLibraryItem -->
<!-- TemplateEndEditable -->
<div class="catesearch">
    <form action="tim-kiem" method="get" >
        <input name="keywords" type="search" placeholder="Tìm sản phẩm bạn cần " value="{$search_keywords|escape}" autocomplete="off"  />
        <button type="reset" class="reset"><i class="iconmobile-reset"></i></button>
        <button type="submit" class="submit" aria-label="Tìm kiếm"><i class="iconmobile-search"></i></button>
    </form>
</div>
    <!-- TemplateBeginEditable name="Bottom" -->
<!-- #BeginLibraryItem "/library/recommend_best.lbi" -->
{if $best_goods}
<div class="best-good">
    <div class="hometitle best_goods">Sản phẩm {$lang.best_goods}</div>
    <div class="overpromo">
    <ul class="homeproduct listpromo" id="show_best">
        {foreach from=$best_goods item=goods name=best_goods}
        <li data-id="{$goods.id}">
            <a href="{$goods.url}" title="{$goods.name|escape:html}">
            {if $goods.thumb_webp}
                <picture>
                    <source width="150" height="150" srcset="{$cdn_path}/{$goods.thumb_webp}" type="image/webp" />
                    <img width="150" height="150" class="photo" src="{$cdn_path}/{$goods.thumb}" alt="{$goods.name|escape:html}"/>
                </picture>
                {else}
                <img width="150" height="150" class="photo" src="{$cdn_path}/{$goods.thumb}" alt="{$goods.name|escape:html}"/>
                {/if}
                {if $goods.discount}<span class="rate">Giảm {$goods.discount}</span>{/if}
                <h3>{$goods.name|escape:html}</h3>
                <div class="price">
                     {if $goods.promote_price}
                    <strong>{$goods.promote_price}</strong><span>{$goods.shop_price}</span>
                     {else}
                    Giá sỉ: <strong>{$goods.shop_price}</strong>
                    {/if}
                </div>
                 <p class="cprice">Giá CK: {$goods.partner_price}</p>

              <!--  <p class="cprice">Giá Lẻ: {$goods.deal_price}</p> -->
               <div class="labelw">
            {if $goods.is_hot}<span class="label is_hot">Nổi bật</span>{/if}
            {if $goods.is_best}<span class="label is_best">Bán chạy</span>{/if}
            {if $goods.is_new}<span class="label is_new">Mới</span>{/if}
            </div>
            </a>
            <div class="form_add form_add{$goods.id}">
            <div class="button-container">
                <button onclick="qtyMinus(this)" class="qty_button cart-qty-minus" type="button" value="-">-</button>
                <input type="text" min="1" max="10" class="qty qty{$goods.id}" step="1" name="goods_number" value="1">
                <button onclick="qtyPlus(this)" class="qty_button cart-qty-plus" type="button" value="+">+</button>
            </div>
            <button class="quick_add" type="button" onclick="quickBuy({$goods.id})"><i class="iconmobile-cart"></i></button>
        </div>
        </li>
        {/foreach}
    </ul>
    </div>
    </div>
{/if}

 <!-- #EndLibraryItem -->
<!-- #BeginLibraryItem "/library/recommend_hot.lbi" -->
{if $hot_goods}
<div class="hot_goods recommend_goods box">
    <div class="hd">
        <div class="box_title">Sản phẩm {$lang.hot_goods}</div>
        <div class="extra"><a href="tim-kiem?intro=hot">Xem tất cả</a></div>
    </div>
    <div class="overpromo">
    <ul class="homeproduct listpromo" id="show_hot">
        {foreach from=$hot_goods item=goods name=hot_goods}
        <li data-id="{$goods.id}">
            <a href="{$goods.url}" title="{$goods.name|escape:html}">
                                {if $goods.thumb_webp}
                <picture>
                    <source width="150" height="150" srcset="{$cdn_path}/{$goods.thumb_webp}" type="image/webp" />
                    <img width="150" height="150" class="photo" src="{$cdn_path}/{$goods.thumb}" alt="{$goods.name|escape:html}"/>
                </picture>
                {else}
                <img width="150" height="150" class="photo" src="{$cdn_path}/{$goods.thumb}" alt="{$goods.name|escape:html}"/>
                {/if}
                {if $goods.discount}<span class="rate">Giảm {$goods.discount}</span>{/if}
                {if $hot_goods.is_hot eq 1} <span class="icon_hot"></span> {/if}

                <h3>{$goods.name|escape:html}</h3>
                <div class="price">
                     {if $goods.promote_price}
                    <strong>{$goods.promote_price}</strong><span>{$goods.shop_price}</span>
                     {else}
                    Giá sỉ: <strong>{$goods.shop_price}</strong>
                    {/if}
                </div>
               <p class="cprice">Giá CK: {$goods.partner_price}</p> 

           <!--     <p class="cprice">Giá Lẻ: {$goods.deal_price}</p> -->
               <div class="labelw">
            {if $goods.is_hot}<span class="label is_hot">Nổi bật</span>{/if}
            {if $goods.is_best}<span class="label is_best">Bán chạy</span>{/if}
            {if $goods.is_new}<span class="label is_new">Mới</span>{/if}
            </div>
            </a>
        </li>
        {/foreach}
    </ul>
    </div>
</div>
{/if}

 <!-- #EndLibraryItem -->
<!-- #BeginLibraryItem "/library/history.lbi" -->
{siy:history}
 <!-- #EndLibraryItem -->
<!-- TemplateEndEditable -->
{include file='library/article_category.lbi'} 

<div class="catesearch">
</div>
    {if $long_desc}
    <div class="clr"></div>
    <article id="description">
            <div class="article_content">
                <h2>{$cat_name}</h2>
            {$long_desc}
            </div>
            <div class="view-more hidden">
                <p id="btn-viewmore"><span id="view1">Đọc thêm </span><span id="view2" class="hidden">Thu gọn </span> </p>
            </div>
    </article>
    {/if}
    {$render.after_col_main}
</section>
{include file='library/page_footer.lbi'}
<script type="text/javascript">
    var cat_id = {$category}, base_path = '{$base_path}/', current_url = '{$cat_url_ajax}';
</script>
{insert_js name='category.Mobile.min.js' no_minify='js/jquery.min.1.8.3.js,js/plugins.js,js/lang.vi_vn.js,owl-carousel/owl.carousel.2.1.min.js' minify='js/global.js,js/init.js'}

<script type="text/javascript">
$(document).ready(function() {
   if($("#owl-home").length > 0){
        $("#owl-home").owlCarousel({navigation:!1,slideSpeed:300,paginationSpeed:400,singleItem:!0,lazyLoad:!0,autoPlay:!0,autoHeight:!0});
    }

    getW('.overpromo');
});
/** view more */
var el = $('#description .article_content');
var h = el.height();

if(h>300){
    el.addClass('short_view');
    $('#description .view-more').removeClass('hidden');
}
$('#btn-viewmore').click(function(e){
    el.toggleClass('short_view');
    $('#view1').toggleClass('hidden');
    $('#view2').toggleClass('hidden');
    e.preventDefault();
});
/** end view more */

/* filter animate  */
$("ul.filter .criteria").click(function() {
    $("ul.filter .criteria").not(this).next().hide();
    $(this).next().slideToggle(200);
  /*  $("body,html").animate({
        scrollTop: $("ul.filter").position().top
    }, 600) */
});
$("ul.filter button.closefilter").click(function() {
    $(this).parent().hide();
});
/* Mở rộng thu gọn danh mục */
$('.boxcat_more').click(function(e){
    $(this).parent().find('li.hidden').removeClass('hidden');
    $(this).addClass('hidden');
    $(this).parent().find('li.boxcat_less').removeClass('hidden');
    e.preventDefault();
});
$('.boxcat_less').click(function(e){
    $(this).parent().find('li.hide_boxcat').addClass('hidden');
    $(this).addClass('hidden');
    $(this).parent().find('li.boxcat_more').removeClass('hidden');
    e.preventDefault();
});

function getW(el){
        var ul = $(el+" ul.listpromo");
        ul.each(function() {
            var li = $(this).find('li');
            var w = li.length*(li.width()+8);
            if(li.length > 1){
                $(this).css('width', w);
            }

        });
    }
function loadMore(cate_url,page,cat_id){
    var page = page != undefined ? page : 2;
    $.post(cate_url,
        {sync: 1, page: page},
        function(response){
            if(response.error == 0){
                $('#_loadList').append(response.goods_list);
                $('.page_ajax').html(response.pagination);
            }else{
                console.log(response.message);
            }
        },
        'json'
    );
}
</script>
{include file='library/html_footer_menu.lbi'}
{include file='library/html_footer.lbi'}
<script>
    // Đợi cho toàn bộ trang web được tải xong rồi mới chạy script
document.addEventListener('DOMContentLoaded', function() {

    // Tìm phần tử nút "Giá"
    const priceDropdownToggle = document.querySelector('.sort-price-dropdown .dropdown-toggle');

    // Kiểm tra xem phần tử có tồn tại không để tránh lỗi
    if (priceDropdownToggle) {
        
        // Lấy phần tử `li` cha chứa cả nút và menu dropdown
        const dropdownContainer = priceDropdownToggle.closest('.sort-price-dropdown');

        // 1. Bật/tắt dropdown khi click vào nút "Giá"
        priceDropdownToggle.addEventListener('click', function(event) {
            // Ngăn hành động mặc định của thẻ <a>
            event.preventDefault(); 
            // Ngăn sự kiện click lan ra ngoài (quan trọng)
            event.stopPropagation(); 
            
            // Thêm hoặc xóa class 'is-open' để bật/tắt menu
            dropdownContainer.classList.toggle('is-open');
        });

        // 2. Tự động đóng dropdown khi click ra ngoài
        document.addEventListener('click', function(event) {
            // Kiểm tra xem dropdown có đang mở VÀ vị trí click có nằm ngoài dropdown không
            if (dropdownContainer.classList.contains('is-open') && !dropdownContainer.contains(event.target)) {
                // Nếu đúng thì xóa class 'is-open' để đóng menu
                dropdownContainer.classList.remove('is-open');
            }
        });
    }

});
</script>
</body>
</html>
